<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parkrun Scraper Bookmarklet</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
        }
        h1 {
            color: #fc4c02;
        }
        .bookmarklet {
            display: inline-block;
            padding: 1rem 2rem;
            background: #fc4c02;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            margin: 1rem 0;
            cursor: move;
        }
        .bookmarklet:hover {
            background: #e04402;
        }
        .instructions {
            background: #f5f5f5;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .step {
            margin: 1rem 0;
        }
        code {
            background: #e0e0e0;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <h1>üèÉ Parkrun Scraper Bookmarklet</h1>

    <p><strong>Drag this button to your bookmarks bar:</strong></p>

    <a href="javascript:(function(){fetch(window.location.origin+'/parkrun-smart-scraper.js').then(r=>r.text()).then(eval)})();"
       class="bookmarklet">
        üèÉ Sync Parkrun
    </a>

    <div class="instructions">
        <h2>How to Use:</h2>

        <div class="step">
            <strong>Step 1:</strong> Drag the button above to your browser's bookmarks bar
        </div>

        <div class="step">
            <strong>Step 2:</strong> Go to your Admin page and set the date range
        </div>

        <div class="step">
            <strong>Step 3:</strong> Click the "Sync Parkrun Data" button<br>
            This will open parkrun with the correct parameters
        </div>

        <div class="step">
            <strong>Step 4:</strong> Click the bookmarklet you just added<br>
            The scraper will automatically run and upload results
        </div>

        <div class="step">
            <strong>Step 5:</strong> Wait ~3-4 minutes for completion<br>
            Results are automatically uploaded to your dashboard
        </div>
    </div>

    <h2>Alternative: Manual Script</h2>

    <p>If you prefer not to use a bookmarklet, you can manually run the script:</p>

    <div class="instructions">
        <div class="step">
            <strong>1.</strong> Open parkrun page (click "Sync Parkrun Data" in Admin)
        </div>

        <div class="step">
            <strong>2.</strong> Open browser console (F12)
        </div>

        <div class="step">
            <strong>3.</strong> Copy and paste this code:
            <pre><code>fetch(window.location.origin + '/parkrun-smart-scraper.js')
  .then(r => r.text())
  .then(eval);</code></pre>
        </div>

        <div class="step">
            <strong>4.</strong> Press Enter and wait for completion
        </div>
    </div>

    <h2>How It Works</h2>

    <ul>
        <li>Fetches the scraper script from your site</li>
        <li>Reads URL parameters for date range and API endpoint</li>
        <li>Scrapes all Saturdays in the date range</li>
        <li>Includes special dates (Dec 25, Jan 1)</li>
        <li>Automatically uploads CSV to your API</li>
        <li>Handles duplicates gracefully</li>
    </ul>

    <p style="margin-top: 2rem; color: #666; font-size: 0.9rem;">
        <strong>Note:</strong> The scraper runs entirely in your browser and respects parkrun's servers with 2-second delays between requests.
    </p>
</body>
</html>
